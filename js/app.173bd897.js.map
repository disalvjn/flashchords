{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?c650","webpack:///./src/components/FlashcardSelector.vue?6c39","webpack:///./src/App.vue?b205","webpack:///./src/components/FlashcardSelector.vue?7815","webpack:///./src/components/FlashcardSelector.vue","webpack:///./src/components/FlashcardSelector.vue?9a0c","webpack:///./src/components/FlashcardSelector.vue?532c","webpack:///./src/components/OptionsEditor.vue?8e43","webpack:///./src/domain/util/util.ts","webpack:///./src/domain/models/notes.ts","webpack:///./src/domain/models/options.ts","webpack:///./src/components/OptionsEditor.vue","webpack:///./src/components/OptionsEditor.vue?3cdb","webpack:///./src/components/OptionsEditor.vue?ae06","webpack:///./src/flashcards/chords/triads/diatonic-major-triads.ts","webpack:///./src/flashcards/chords/triads/diatonic-minor-triads.ts","webpack:///./src/flashcards/chords/singlets.ts","webpack:///./src/flashcards/chords/chord-entities.ts","webpack:///./src/domain/models/flashcard.ts","webpack:///./src/domain/models/category.ts","webpack:///./src/domain/services/cardDrawer.ts","webpack:///./src/domain/services/soundPlayer.ts","webpack:///./src/domain/services/midiBatcher.ts","webpack:///./src/domain/services/flashcardDeriver.ts","webpack:///./src/App.vue","webpack:///./src/App.vue?0ab4","webpack:///./src/App.vue?bff9","webpack:///./src/store/index.ts","webpack:///./src/main.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","practiceState","_v","_s","currentCardDescription","_e","selectedFlashcardIds","staticClass","pianoLoaded","on","drawCard","giveUp","playCard","$event","recordResult","loadPiano","loadAll","model","callback","$$v","options","expression","attrs","categories","staticRenderFns","selected","newVal","oldVal","emitSelected","immediate","deep","components","VTreeview","VContainer","VRow","VCol","component","onJsonChange","mapcat","items","f","forEach","randomNumberBetweenInclusive","low","high","Math","floor","random","drawRandom","drawRandomSample","size","repeatOptions","Error","toString","picked","Set","has","add","lastPick","nextPick","shuffleArray","array","doTimes","count","indexBy","Map","x","set","solfegeNote","solfege","tonic","kind","scientificNote","pitchClass","octave","class","midiNote","midi","noteDropdownOptions","num","map","letter","NoteToMidi","note","toMidi","offsetFromRoot","octaveOffset","toSolfege","console","log","toOctaveSolfege","maxOffsetSoFar","baseOffset","withOctave","defaultOptions","play","drone","referenceNote","playReference","bpm","priorities","percentNew","byPercentiles","derivation","lowestNote","highestNote","tonality","chunkSize","chunkType","repeats","cards","apreggiateChords","commands","replay","nextCard","newValue","emit","VSelect","VCheckbox","VTextField","VBtn","vueJsonEditor","diatonicMajorTriads","function","inv","category","notes","diatonicMinorTriads","singlets","chordEntities","concat","getMusicalPhrase","flashcard","sequence","octaveInstantiatedChord","base","id","bases","join","polychord","chordEntityToModel","entity","split","inversion","reifyHelper","idCategories","categoriesByPath","item","path","index","newPath","children","parent","leaf","topLevelNames","topLevelCategories","Array","from","reifyCategories","flashcards","_lastCard","_newCards","_priorities","_attempts","_flashcardToIndex","drawNewCard","drawAttemptedCard","pickByPercentages","e","drawFromEquallySizedGroupsBasedOnPercentages","flashcardId","success","currentPlace","card","totalTries","successful","failed","maintainSort","pop","next","current","a","filter","attempts","locations","percentHit","lessThan","b","greaterThan","swap","list","tmp","maintainSortByTricklingDown","maintainSortByTricklingUp","percentages","partitions","indexGroups","divideEquallyIntoInclusiveIndices","percent","intoCumulativePercentages","soFar","probabilitiesAndActions","cumulative","roughSizePerGroupFrac","dividesCleanly","roughSizePerGroup","ceil","realHigh","min","reverse","_piano","_options","resume","context","toDestination","load","phrase","time","playChord","chord","start","end","bpmFactor","toTime","midiNotes","keyDown","keyUp","config","_target","_failedYet","_input","_batchSizes","_maxInputLength","_config","_emit","reduce","batched","batch","batchesEqual","onFirstGuess","inputs","batchSizes","batchSize","_","batchEqual","aSet","every","derive","transposed","instantiateInOctaves","createSequence","createPolychord","chordNotes","arpeggiate","sampleOptions","uniqueNotes","sort","tonicPitch","octaves","lowestNoteMidi","highestNoteMidi","candidate","midis","max","chords","activeFlashcards","cardDrawer","player","undefined","midiBatcher","currentCardId","wrongGuesses","resetPriorities","platonicCardsById","resetFlashcards","enable","ex","outputs","input","addListener","accept","number","setEmit","event","currentCard","resetTarget","recordAttempt","playMusicalPhrase","chordsbyId","FlashcardSelector","OptionsEditor","VApp","VMain","VTabs","VTab","VTabItem","use","Store","state","mutations","actions","vuetify","productionTip","store","render","h","$mount"],"mappings":"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","file":"js/app.173bd897.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FlashcardSelector.vue?vue&type=style&index=0&id=014bcfce&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-app',[_c('v-main',[(_vm.pianoLoaded)?_c('v-container',[(this.practiceState.giveUp)?_c('v-row',[_c('v-col',[_c('h2',[_vm._v(_vm._s(_vm.currentCardDescription))])])],1):_vm._e(),(this.selectedFlashcardIds.length == 0)?_c('v-row',[_c('v-col',{staticClass:\"md-12\"},[_c('h2',[_vm._v(\"No Flashcards Selected\")])])],1):(!_vm.pianoLoaded)?_c('v-row',[_c('v-btn',{on:{\"click\":_vm.loadPiano}},[_c('h1',[_vm._v(\"Load Piano\")])])],1):_c('v-row',[_c('v-col',{staticClass:\"md-2\"},[_c('v-btn',{on:{\"click\":_vm.drawCard}},[_vm._v(\"Draw Card\")])],1),_c('v-col',{staticClass:\"md-2\"},[_c('v-btn',{on:{\"click\":_vm.giveUp}},[_vm._v(\"Give Up\")])],1),_c('v-col',{staticClass:\"md-2\"},[_c('v-btn',{on:{\"click\":_vm.playCard}},[_vm._v(\"Play Card\")])],1),_c('v-col',{staticClass:\"md-2\"},[_c('v-btn',{on:{\"click\":function($event){return _vm.recordResult(true)}}},[_vm._v(\"Succeed\")])],1),_c('v-col',{staticClass:\"md-2\"},[_c('v-btn',{on:{\"click\":function($event){return _vm.recordResult(false)}}},[_vm._v(\"Fail\")])],1)],1)],1):_c('v-container',[_c('v-row',[_c('v-col',{staticClass:\"lg-4\"}),_c('v-col',{staticClass:\"lg-4\"},[_c('v-btn',{on:{\"click\":_vm.loadAll}},[_vm._v(\"Proceed Irreversibly\")])],1),_c('v-col',{staticClass:\"lg-4\"})],1),_c('v-row',[_c('v-col',{staticClass:\"lg-6\"},[_c('options-editor',{model:{value:(_vm.options),callback:function ($$v) {_vm.options=$$v},expression:\"options\"}})],1),_c('v-col',{staticClass:\"lg-6\"},[_c('flashcardSelector',{attrs:{\"categories\":_vm.categories},model:{value:(_vm.selectedFlashcardIds),callback:function ($$v) {_vm.selectedFlashcardIds=$$v},expression:\"selectedFlashcardIds\"}})],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',[_c('v-row',[_c('v-col',{staticClass:\"lg-6\"},[_c('v-treeview',{attrs:{\"open-all\":\"\",\"selectable\":\"\",\"dense\":\"\",\"items\":_vm.categories,\"item-children\":\"children\",\"item-key\":\"id\",\"item-text\":\"name\"},model:{value:(_vm.selected),callback:function ($$v) {_vm.selected=$$v},expression:\"selected\"}})],1),_c('v-col',{staticClass:\"lg-6\"})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Watch, Emit, Prop, Vue } from \"vue-property-decorator\";\r\nimport { Category } from \"../domain/models/category\";\r\nimport { VContainer, VRow, VCol, VTreeview } from \"vuetify/lib\";\r\n\r\n@Component ({\r\n  components: {\r\n    VTreeview, VContainer, VRow, VCol\r\n  }\r\n})\r\nexport default class FlashcardSelector extends Vue {\r\n  @Prop() private categories!: Category[];\r\n  private selected: string[] = [];\r\n\r\n  @Watch('selected', {immediate: true, deep: true})\r\n  newSelection(newVal: string[], oldVal: string[]) {\r\n    this.emitSelected(newVal);\r\n  }\r\n  \r\n  @Emit('input')\r\n  emitSelected(selected: string[]) {\r\n    const placeholderUntilIDeleteEsLintNoEmptyFunction = 0;\r\n  }\r\n\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FlashcardSelector.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FlashcardSelector.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FlashcardSelector.vue?vue&type=template&id=014bcfce&scoped=true&\"\nimport script from \"./FlashcardSelector.vue?vue&type=script&lang=ts&\"\nexport * from \"./FlashcardSelector.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./FlashcardSelector.vue?vue&type=style&index=0&id=014bcfce&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"014bcfce\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('vue-json-editor',{attrs:{\"expandedOnStart\":true},on:{\"json-change\":_vm.onJsonChange},model:{value:(_vm.options),callback:function ($$v) {_vm.options=$$v},expression:\"options\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// This is flatmap, but JSRepl complains about flatmap, so I have to write my own.\r\n export function mapcat<A, B>(items: A[], f: (a: A) => B[]): B[] {\r\n    const result: B[] = [];\r\n    items.forEach(i => {\r\n        f(i).forEach(j => result.push(j));\r\n    });\r\n    return result;\r\n}\r\n\r\nexport function randomNumberBetweenInclusive(low: number, high: number) {\r\n    return Math.floor(Math.random() * (high - low + 1) + low);\r\n}\r\n\r\nexport function drawRandom<T>(items: T[]): T {\r\n    return items[randomNumberBetweenInclusive(0, items.length - 1)];\r\n}\r\n\r\nexport type RandomSampleRepeatOptions = \"no-repeats\" | \"non-sequential-repeats\" | \"allow-repeats\"\r\nexport function drawRandomSample<T>(items: T[], size: number, repeatOptions: RandomSampleRepeatOptions): T[] {\r\n    const result: T[] = [];\r\n\r\n    if (repeatOptions == \"allow-repeats\") {\r\n        for (let i = 0; i < size; i++) {\r\n            result.push(drawRandom(items));\r\n        }\r\n    } else if (repeatOptions == \"no-repeats\") {\r\n        if (size > items.length) {\r\n            throw new Error(\"can't randomly sample \" + size.toString() + \" items with no repeats from a list with \" + items.length.toString() + \" elements.\");\r\n        }\r\n\r\n        const picked = new Set<number>();\r\n        let i = randomNumberBetweenInclusive(0, items.length - 1);\r\n\r\n        while (result.length < size) {\r\n            while (picked.has(i)) {\r\n                i = randomNumberBetweenInclusive(0, items.length - 1);\r\n            }\r\n            result.push(items[i]);\r\n            picked.add(i);\r\n        }\r\n    } else if (repeatOptions == \"non-sequential-repeats\") {\r\n        let lastPick = randomNumberBetweenInclusive(0, items.length - 1);\r\n        let nextPick = lastPick;\r\n        while (result.length < size) {\r\n            while (lastPick == nextPick) {\r\n                nextPick = randomNumberBetweenInclusive(0, items.length - 1);\r\n            }\r\n            result.push(items[nextPick]);\r\n            lastPick = nextPick;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n// https://stackoverflow.com/a/12646864\r\nexport function shuffleArray<T>(array: T[]) {\r\n    for (let i = array.length - 1; i > 0; i--) {\r\n        const j = Math.floor(Math.random() * (i + 1));\r\n        [array[i], array[j]] = [array[j], array[i]];\r\n    }\r\n}\r\n\r\nexport function doTimes<T>(f: () => T, count: number): T[] {\r\n    const result: T[] = [];\r\n    for (let i = 0; i < count; i++) {\r\n        result.push(f());\r\n    }\r\n    return result;\r\n}\r\n\r\nexport function indexBy<K, V>(items: V[], f: (v: V) => K): Map<K, V> {\r\n    const result = new Map<K, V>();\r\n    items.forEach(x => result.set(f(x), x));\r\n    return result;\r\n}","import { Frequency } from \"tone\";\r\nimport { mapcat } from \"../util/util\";\r\n\r\nexport type PitchClass = \"A\" | \"Bb\" | \"B\" | \"C\" | \"Db\" | \"D\" | \"Eb\" | \"E\" | \"F\" | \"F#\" | \"G\" | \"Ab\";\r\nexport type Octave = 1 | 2 | 3 | 4 | 5 | 6  | 7 | 8;\r\n\r\nexport type MidiNote = number;\r\n\r\nexport type SolfegeClass = \"do\" \r\n    | \"ra\" | \"re\" | \"ri\" \r\n    | \"me\" | \"mi\"\r\n    | \"fa\" | \"fi\"\r\n    | \"se\" | \"so\" | \"si\" \r\n    | \"le\" | \"la\" | \"li\"\r\n    | \"te\" | \"ti\"\r\n\r\nexport type OctaveSolfegeRelative = {octaveOffset: number, solfege: SolfegeClass};\r\n\r\nexport type Note =  \r\n    {kind: \"solfege\", solfege: OctaveSolfegeRelative, tonic: Note}\r\n    | {kind: \"midi\", midi: number} \r\n    | {kind: \"scientific\", class: PitchClass, octave: Octave};\r\n\r\nexport function solfegeNote(solfege: OctaveSolfegeRelative, tonic: Note): Note {\r\n    return {kind: \"solfege\", solfege: solfege, tonic: tonic};\r\n}\r\n\r\nexport function scientificNote(pitchClass: PitchClass, octave: Octave): Note {\r\n    return {kind: \"scientific\", class: pitchClass, octave: octave};\r\n}\r\n\r\nexport function midiNote(midi: number): Note {\r\n    return {kind: \"midi\", midi: midi};\r\n}\r\n\r\nexport type MusicalPhrase = Note[][];\r\n\r\nexport const noteDropdownOptions = ['A', 'Bb', 'B', 'C', 'Db', 'D', 'Eb', 'E', 'F', 'F#', 'G', 'Ab'];\r\n\r\nexport const numberedNoteDropdownOptions: string[] = mapcat(\r\n    [1, 2, 3, 4, 5, 6, 7, 8],\r\n    num => noteDropdownOptions.map(letter => letter + num.toString())\r\n);\r\n\r\nexport function NoteToMidi(note: Note): MidiNote {\r\n    return note.kind == \"midi\" ? note.midi\r\n        : note.kind == \"scientific\" ? Frequency(note.class + note.octave.toString()).toMidi()\r\n        : offsetFromRoot(note.solfege.solfege) + 12 * note.solfege.octaveOffset + NoteToMidi(note.tonic);\r\n}\r\n\r\nexport type NoteComparison = \"greater\" | \"equal\" | \"lesser\"\r\nexport function compareNotes(n: Note, m: Note): NoteComparison {\r\n    const x = NoteToMidi(n); const y = NoteToMidi(m);\r\n    return x < y ? \"lesser\" : x > y ? \"greater\" : \"equal\";\r\n}\r\n\r\nexport function offsetFromRoot(solfege: SolfegeClass): number {\r\n    return solfege == \"do\" ? 0\r\n        : solfege == \"ra\" ? 1\r\n        : solfege == \"re\" ? 2\r\n        : solfege == \"ri\" ? 3\r\n        : solfege == \"me\" ? 3\r\n        : solfege == \"mi\" ? 4\r\n        : solfege == \"fa\" ? 5\r\n        : solfege == \"fi\" ? 6\r\n        : solfege == \"se\" ? 6\r\n        : solfege == \"so\" ? 7\r\n        : solfege == \"si\" ? 8\r\n        : solfege == \"le\" ? 8\r\n        : solfege == \"la\" ? 9\r\n        : solfege == \"li\" ? 10\r\n        : solfege == \"te\" ? 10\r\n        : solfege == \"ti\" ? 11\r\n        : -1; \r\n}\r\n\r\nexport function toSolfege(solfege: string): SolfegeClass {\r\n    if (offsetFromRoot(solfege as SolfegeClass) == -1) {\r\n        console.log(\"Not valid solfege: \" + solfege);\r\n        throw new Error(\"Invalid solfege: \" + solfege);\r\n    } else {\r\n        return solfege as SolfegeClass;\r\n    }\r\n}\r\n\r\n// just for ascending chords\r\nexport function toOctaveSolfege(solfege: SolfegeClass[]): OctaveSolfegeRelative[] {\r\n    let maxOffsetSoFar = -1;\r\n    let octave = 0;\r\n    const result: OctaveSolfegeRelative[] = [];\r\n\r\n    solfege.forEach(note => {\r\n        const baseOffset = offsetFromRoot(note) ?? 0;\r\n        while (baseOffset + octave * 12 <= maxOffsetSoFar) {\r\n            octave++;\r\n        }\r\n        const withOctave = baseOffset + 12 * octave;\r\n        maxOffsetSoFar = withOctave;\r\n        result.push({solfege: note, octaveOffset: octave});\r\n    });\r\n    return result;\r\n}","import { Note, PitchClass, scientificNote } from \"./notes\";\r\nimport { RandomSampleRepeatOptions } from \"../util/util\";\r\n\r\nexport type ChunkType = \"sequence\" | \"polychord\";\r\nexport type Tonality = \r\n    | {kind: \"tonal\", tonic: PitchClass };\r\n    // | {kind: \"atonal-fixed\", commonRoot: PitchClass }\r\n    // | {kind: \"chromatically-transposed\" }\r\n\r\nexport type DerivationOptions = {\r\n    lowestNote: Note;\r\n    highestNote: Note;\r\n    tonality: Tonality;\r\n    chunkSize: number;\r\n    chunkType: ChunkType;\r\n    repeats: RandomSampleRepeatOptions;\r\n    cards: number;\r\n    apreggiateChords: boolean;\r\n}\r\n\r\nexport type MidiBatcherConfig = {\r\n    giveUp: Note;\r\n    nextCard: Note;\r\n    replay: Note;\r\n}\r\n\r\nexport type PlayOptions = {\r\n    drone: boolean;\r\n    referenceNote: Note;\r\n    playReference: boolean;\r\n    bpm: number;\r\n}\r\n\r\nexport type Options = {\r\n\r\n    play: PlayOptions;\r\n\r\n    priorities: Priorities;\r\n\r\n    derivation: DerivationOptions;\r\n\r\n    commands: MidiBatcherConfig;\r\n}\r\n\r\n\r\n// 60 20 20 | 50 \r\n// would mean 50% new cards that haven't been tested yet, until that runs out\r\n// then when a previously tested card is pulled, there is a :\r\n// 60% chance it's a card that is in the bottom third of your performance\r\n// 20% for 33-66th percentile\r\n// 20% for 67-100th percentile \r\nexport type Priorities = {\r\n    percentNew: number;\r\n    byPercentiles: number[];\r\n}\r\n\r\nexport const defaultOptions: Options = {\r\n    play: {\r\n        drone: false,\r\n        referenceNote: scientificNote(\"A\", 3),\r\n        playReference: true,\r\n        bpm: 60\r\n    },\r\n    priorities: {\r\n        percentNew: 50,\r\n        byPercentiles: [65, 35]\r\n    },\r\n    derivation: {\r\n        lowestNote: scientificNote(\"F#\", 2),\r\n        highestNote: scientificNote(\"D\", 5),\r\n        tonality: {kind: \"tonal\", tonic: \"A\"},\r\n        chunkSize: 1,\r\n        chunkType: \"sequence\",\r\n        repeats: \"non-sequential-repeats\",\r\n        cards: 20,\r\n        apreggiateChords: false\r\n    },\r\n    commands: {\r\n        giveUp: scientificNote(\"Ab\", 7),\r\n        replay: scientificNote(\"F#\", 7),\r\n        nextCard: scientificNote(\"Bb\", 7)\r\n    }\r\n};","\n\n\n\n\n\n\r\nimport { Component, Watch, Emit, Prop, Vue } from \"vue-property-decorator\";\r\nimport { VBtn, VContainer, VRow, VCol, VSelect,VCheckbox, VTextField } from \"vuetify/lib\";\r\nimport { defaultOptions, Options } from \"../domain/models/options\";\r\nimport { Note, Octave, PitchClass, numberedNoteDropdownOptions } from \"../domain/models/notes\";\r\nimport vueJsonEditor from \"vue-json-editor\";\r\n\r\n@Component ({\r\n  components: {\r\n      VContainer, VRow, VCol,\r\n      VSelect, VCheckbox, VTextField,\r\n      VBtn, vueJsonEditor\r\n  }\r\n})\r\nexport default class OptionsEditor extends Vue {\r\n\r\n    private options: Options = { ... defaultOptions, priorities: { ... defaultOptions.priorities } };\r\n\r\n    onJsonChange(newValue: Options) {\r\n        this.options = newValue;\r\n        this.emit();\r\n    }\r\n\r\n    @Emit('input')\r\n    emit(): Options {\r\n        return this.options;\r\n    }\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OptionsEditor.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OptionsEditor.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./OptionsEditor.vue?vue&type=template&id=5567edc6&\"\nimport script from \"./OptionsEditor.vue?vue&type=script&lang=ts&\"\nexport * from \"./OptionsEditor.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { ChordFlashcardEntity } from \"@/domain/entities/chord-flashcard-entity\"\r\n\r\nexport const diatonicMajorTriads: ChordFlashcardEntity[] = \r\n[\r\n    {\r\n        function: \"I\",\r\n        inv: \"R 3 5\",\r\n        category: \"triads.diatonic.major.R35\",\r\n        notes: \"do mi so\"\r\n    },\r\n    {\r\n        function: \"ii\",\r\n        inv: \"R 3 5\",\r\n        category: \"triads.diatonic.major.R35\",\r\n        notes: \"re fa la\"\r\n    },\r\n    {\r\n        function: \"iii\",\r\n        inv: \"R 3 5\",\r\n        category: \"triads.diatonic.major.R35\",\r\n        notes: \"mi so ti\"\r\n    },\r\n    {\r\n        function: \"IV\",\r\n        inv: \"R 3 5\",\r\n        category: \"triads.diatonic.major.R35\",\r\n        notes: \"fa la do\"\r\n    },\r\n    {\r\n        function: \"V\",\r\n        inv: \"R 3 5\",\r\n        category: \"triads.diatonic.major.R35\",\r\n        notes: \"so ti re\"\r\n    },\r\n    {\r\n        function: \"vi\",\r\n        inv: \"R 3 5\",\r\n        category: \"triads.diatonic.major.R35\",\r\n        notes: \"la do mi\"\r\n    },\r\n    {\r\n        function: \"vii b5\",\r\n        inv: \"R 3 5\",\r\n        category: \"triads.diatonic.major.R35\",\r\n        notes: \"ti re fa\"\r\n    },\r\n    {\r\n        function: \"I\",\r\n        inv: \"3 5 R\",\r\n        category: \"triads.diatonic.major.35R\",\r\n        notes: \"mi so do\"\r\n    },\r\n    {\r\n        function: \"ii\",\r\n        inv: \"3 5 R\",\r\n        category: \"triads.diatonic.major.35R\",\r\n        notes: \"fa la re\"\r\n    },\r\n    {\r\n        function: \"iii\",\r\n        inv: \"3 5 R\",\r\n        category: \"triads.diatonic.major.35R\",\r\n        notes: \"so ti mi\"\r\n    },\r\n    {\r\n        function: \"IV\",\r\n        inv: \"3 5 R\",\r\n        category: \"triads.diatonic.major.35R\",\r\n        notes: \"la do fa\"\r\n    },\r\n    {\r\n        function: \"V\",\r\n        inv: \"3 5 R\",\r\n        category: \"triads.diatonic.major.35R\",\r\n        notes: \"ti re so\"\r\n    },\r\n    {\r\n        function: \"vi\",\r\n        inv: \"3 5 R\",\r\n        category: \"triads.diatonic.major.35R\",\r\n        notes: \"do mi la\"\r\n    },\r\n    {\r\n        function: \"vii b5\",\r\n        inv: \"3 5 R\",\r\n        category: \"triads.diatonic.major.35R\",\r\n        notes: \"re fa ti\"\r\n    },\r\n    {\r\n        function: \"I\",\r\n        inv: \"5 R 3\",\r\n        category: \"triads.diatonic.major.5R3\",\r\n        notes: \"so do mi\"\r\n    },\r\n    {\r\n        function: \"ii\",\r\n        inv: \"5 R 3\",\r\n        category: \"triads.diatonic.major.5R3\",\r\n        notes: \"la re fa\"\r\n    },\r\n    {\r\n        function: \"iii\",\r\n        inv: \"5 R 3\",\r\n        category: \"triads.diatonic.major.5R3\",\r\n        notes: \"ti mi so\"\r\n    },\r\n    {\r\n        function: \"IV\",\r\n        inv: \"5 R 3\",\r\n        category: \"triads.diatonic.major.5R3\",\r\n        notes: \"do fa la\"\r\n    },\r\n    {\r\n        function: \"V\",\r\n        inv: \"5 R 3\",\r\n        category: \"triads.diatonic.major.5R3\",\r\n        notes: \"re so ti\"\r\n    },\r\n    {\r\n        function: \"vi\",\r\n        inv: \"5 R 3\",\r\n        category: \"triads.diatonic.major.5R3\",\r\n        notes: \"mi la do\"\r\n    },\r\n    {\r\n        function: \"vii b5\",\r\n        inv: \"5 R 3\",\r\n        category: \"triads.diatonic.major.5R3\",\r\n        notes: \"fa ti re\"\r\n    }\r\n];","import { ChordFlashcardEntity } from \"@/domain/entities/chord-flashcard-entity\"\r\n\r\nexport const diatonicMinorTriads: ChordFlashcardEntity[] = \r\n\r\n[\r\n    {\r\n        function: \"i\",\r\n        inv: \"R 3 5\",\r\n        category: \"triads.diatonic.minor.R35\",\r\n        notes: \"do me so\"\r\n    },\r\n    {\r\n        function: \"ii b5\",\r\n        inv: \"R 3 5\",\r\n        category: \"triads.diatonic.minor.R35\",\r\n        notes: \"re fa le\"\r\n    },\r\n    {\r\n        function: \"bIII\",\r\n        inv: \"R 3 5\",\r\n        category: \"triads.diatonic.minor.R35\",\r\n        notes: \"me so te\"\r\n    },\r\n    {\r\n        function: \"iv\",\r\n        inv: \"R 3 5\",\r\n        category: \"triads.diatonic.minor.R35\",\r\n        notes: \"fa le do\"\r\n    },\r\n    {\r\n        function: \"v\",\r\n        inv: \"R 3 5\",\r\n        category: \"triads.diatonic.minor.R35\",\r\n        notes: \"so te re\"\r\n    },\r\n    {\r\n        function: \"bVI\",\r\n        inv: \"R 3 5\",\r\n        category: \"triads.diatonic.minor.R35\",\r\n        notes: \"le do me\"\r\n    },\r\n    {\r\n        function: \"bVII\",\r\n        inv: \"R 3 5\",\r\n        category: \"triads.diatonic.minor.R35\",\r\n        notes: \"te re fa\"\r\n    },\r\n    {\r\n        function: \"i\",\r\n        inv: \"3 5 R\",\r\n        category: \"triads.diatonic.minor.35R\",\r\n        notes: \"me so do\"\r\n    },\r\n    {\r\n        function: \"ii b5\",\r\n        inv: \"3 5 R\",\r\n        category: \"triads.diatonic.minor.35R\",\r\n        notes: \"fa le re\"\r\n    },\r\n    {\r\n        function: \"bIII\",\r\n        inv: \"3 5 R\",\r\n        category: \"triads.diatonic.minor.35R\",\r\n        notes: \"so te me\"\r\n    },\r\n    {\r\n        function: \"iv\",\r\n        inv: \"3 5 R\",\r\n        category: \"triads.diatonic.minor.35R\",\r\n        notes: \"le do fa\"\r\n    },\r\n    {\r\n        function: \"v\",\r\n        inv: \"3 5 R\",\r\n        category: \"triads.diatonic.minor.35R\",\r\n        notes: \"te re so\"\r\n    },\r\n    {\r\n        function: \"bVI\",\r\n        inv: \"3 5 R\",\r\n        category: \"triads.diatonic.minor.35R\",\r\n        notes: \"do me le\"\r\n    },\r\n    {\r\n        function: \"bVII\",\r\n        inv: \"3 5 R\",\r\n        category: \"triads.diatonic.minor.35R\",\r\n        notes: \"re fa te\"\r\n    },\r\n    {\r\n        function: \"i\",\r\n        inv: \"5 R 3\",\r\n        category: \"triads.diatonic.minor.5R3\",\r\n        notes: \"so do me\"\r\n    },\r\n    {\r\n        function: \"ii b5\",\r\n        inv: \"5 R 3\",\r\n        category: \"triads.diatonic.minor.5R3\",\r\n        notes: \"le re fa\"\r\n    },\r\n    {\r\n        function: \"bIII\",\r\n        inv: \"5 R 3\",\r\n        category: \"triads.diatonic.minor.5R3\",\r\n        notes: \"te me so\"\r\n    },\r\n    {\r\n        function: \"iv\",\r\n        inv: \"5 R 3\",\r\n        category: \"triads.diatonic.minor.5R3\",\r\n        notes: \"do fa le\"\r\n    },\r\n    {\r\n        function: \"v\",\r\n        inv: \"5 R 3\",\r\n        category: \"triads.diatonic.minor.5R3\",\r\n        notes: \"re so te\"\r\n    },\r\n    {\r\n        function: \"bVI\",\r\n        inv: \"5 R 3\",\r\n        category: \"triads.diatonic.minor.5R3\",\r\n        notes: \"me le do\"\r\n    },\r\n    {\r\n        function: \"bVII\",\r\n        inv: \"5 R 3\",\r\n        category: \"triads.diatonic.minor.5R3\",\r\n        notes: \"fa te re\"\r\n    }\r\n];","\r\nimport { ChordFlashcardEntity } from \"@/domain/entities/chord-flashcard-entity\";\r\n\r\nexport const singlets: ChordFlashcardEntity[] = \r\n[\r\n    {\r\n        function: \"do\",\r\n        inv: \"do\",\r\n        category: \"singlets\",\r\n        notes: \"do\"\r\n    },\r\n    {\r\n        function: \"ra\",\r\n        inv: \"ra\",\r\n        category: \"singlets\",\r\n        notes: \"ra\"\r\n    },\r\n    {\r\n        function: \"re\",\r\n        inv: \"re\",\r\n        category: \"singlets\",\r\n        notes: \"re\"\r\n    },\r\n    {\r\n        function: \"ri/me\",\r\n        inv: \"ri/me\",\r\n        category: \"singlets\",\r\n        notes: \"me\"\r\n    },\r\n    {\r\n        function: \"mi\",\r\n        inv: \"mi\",\r\n        category: \"singlets\",\r\n        notes: \"mi\"\r\n    },\r\n    {\r\n        function: \"fa\",\r\n        inv: \"fa\",\r\n        category: \"singlets\",\r\n        notes: \"fa\"\r\n    },\r\n    {\r\n        function: \"fi/se\",\r\n        inv: \"fi/se\",\r\n        category: \"singlets\",\r\n        notes: \"fi\"\r\n    },\r\n    {\r\n        function: \"so\",\r\n        inv: \"so\",\r\n        category: \"singlets\",\r\n        notes: \"so\"\r\n    },\r\n    {\r\n        function: \"si/le\",\r\n        inv: \"si/le\",\r\n        category: \"singlets\",\r\n        notes: \"le\"\r\n    },\r\n    {\r\n        function: \"la\",\r\n        inv: \"la\",\r\n        category: \"singlets\",\r\n        notes: \"la\"\r\n    },\r\n    {\r\n        function: \"li/te\",\r\n        inv: \"li/te\",\r\n        category: \"singlets\",\r\n        notes: \"te\"\r\n    },\r\n    {\r\n        function: \"ti\",\r\n        inv: \"ti\",\r\n        category: \"singlets\",\r\n        notes: \"ti\"\r\n    },\r\n];","import { diatonicMajorTriads } from './triads/diatonic-major-triads';\r\nimport { diatonicMinorTriads } from './triads/diatonic-minor-triads';\r\nimport { singlets } from './singlets';\r\n\r\nconst chordEntities = diatonicMajorTriads.concat(diatonicMinorTriads).concat(singlets);\r\n\r\nexport { chordEntities }","import { ChordFlashcardEntity } from \"../entities/chord-flashcard-entity\";\r\nimport { OctaveSolfegeRelative, toSolfege, toOctaveSolfege, MusicalPhrase, Note, PitchClass } from \"./notes\";\r\n\r\nexport type PlatonicFlashcardId = string;\r\nexport type DerivedFlashcardId = string;\r\n\r\ninterface PlatonicFlashcardWithId {\r\n    readonly id: PlatonicFlashcardId;\r\n}\r\n\r\ninterface DerivedFlashcardWithId {\r\n    readonly id: DerivedFlashcardId;\r\n}\r\n\r\nexport type PlatonicFlashcard = PlatonicFlashcardWithId &\r\n    ({kind: \"chord\", function: string, inversion: string, notes: OctaveSolfegeRelative[], category: string[]});\r\n\r\nexport type DerivedFlashcard = DerivedFlashcardWithId &\r\n    ({kind: \"octave-instantiated-chord\", octave: number, tonic: PitchClass, notes: Note[], base: PlatonicFlashcardId}\r\n    | {kind: \"sequence\", sequence: Note[][], bases: DerivedFlashcardId[]}\r\n    | {kind: \"polychord\", bases: DerivedFlashcardId[], notes: Note[]});\r\n\r\nexport function getMusicalPhrase(flashcard: DerivedFlashcard): MusicalPhrase {\r\n    return flashcard.kind == \"octave-instantiated-chord\" ? [flashcard.notes]\r\n        : flashcard.kind == \"sequence\" ? flashcard.sequence\r\n        : [flashcard.notes];\r\n}\r\n\r\nexport function octaveInstantiatedChord(octave: number, tonic: PitchClass, notes: Note[], base: PlatonicFlashcardId): DerivedFlashcard {\r\n    return {\r\n        id: \"tonic=\" + tonic + octave.toString() + \" chord: \" + base,\r\n        kind: \"octave-instantiated-chord\",\r\n        base: base,\r\n        tonic: tonic,\r\n        octave: octave,\r\n        notes: notes\r\n    };\r\n}\r\n\r\nexport function sequence(notes: Note[][], bases: DerivedFlashcardId[]): DerivedFlashcard {\r\n    return {\r\n        id: \"sequence: \" + bases.join(\"  && \"),\r\n        kind: \"sequence\",\r\n        bases: bases,\r\n        sequence: notes\r\n    };\r\n}\r\n\r\nexport function polychord(notes: Note[], bases: DerivedFlashcardId[]): DerivedFlashcard {\r\n    return {\r\n        id: \"polychord: \" + bases.join(\" && \"),\r\n        kind: \"polychord\",\r\n        bases: bases,\r\n        notes: notes\r\n    };\r\n}\r\n\r\nexport function chordEntityToModel(entity: ChordFlashcardEntity): PlatonicFlashcard {\r\n    const notes = toOctaveSolfege(entity.notes.split(\" \").map(toSolfege));\r\n    return {\r\n        id: entity.function + \" : \" + entity.inv,\r\n        function: entity.function,\r\n        inversion: entity.inv,\r\n        category: entity.category.split(\".\"),\r\n        notes: notes,\r\n        kind: \"chord\"\r\n    };\r\n};\r\n\r\nexport function getMusicalPhrasePlatonic(flashcard: PlatonicFlashcard, tonic: Note): MusicalPhrase {\r\n    if (flashcard.kind == \"chord\") {\r\n        const chord: Note[] = flashcard.notes.map(s => ({kind: \"solfege\", solfege: s, tonic: tonic}));\r\n        return [chord];\r\n    } else {\r\n        throw Error(\"Unsupported platonic flashcard type: \" + flashcard.kind);\r\n    }\r\n}\r\n\r\n// console.log(chordEntityToModel({function: \"iii\", inv: \"R 3 5 R 9\", category: \"triads.diatonic.major\", notes: \"do re mi do re\"}))\r\n// console.log(chordEntityToModel({function: \"iii\", inv: \"R 3 5\", category: \"triads.diatonic.major\", notes: \"do do re do re\"}))","import { PlatonicFlashcard } from \"./flashcard\";\r\n\r\ninterface Category {\r\n    readonly id: string;\r\n    readonly name: string;\r\n}\r\n\r\ninterface ParentCategory extends Category {\r\n    readonly children: Category[];\r\n}\r\n\r\nfunction reifyHelper(idCategories: {id: string, category: string[]}[]): Category[] {\r\n    const categoriesByPath: Map<string, ParentCategory> = new Map<string, ParentCategory>();\r\n\r\n    idCategories.forEach(item => {\r\n        let path = \"\";\r\n        item.category.forEach((c, index) => {\r\n            const newPath = path == \"\" ? c : path + \".\" + c;\r\n\r\n            // if this category hasn't been created yet\r\n            if (!categoriesByPath.has(newPath)) {\r\n                const category = {id: newPath, name: c, children: []};\r\n                categoriesByPath.set(newPath, category);\r\n\r\n                // if there's a parent\r\n                if (categoriesByPath.has(path)) {\r\n                    const parent = categoriesByPath.get(path)!;\r\n                    parent.children!.push(category);\r\n                }\r\n            }\r\n\r\n            if (index == item.category.length - 1) {\r\n                const leaf = { id: item.id, name: item.id };\r\n                const parent = categoriesByPath.get(newPath)!;\r\n                parent.children!.push(leaf);\r\n            }\r\n\r\n            path = newPath;\r\n        });\r\n    });\r\n\r\n    const topLevelNames = new Set(idCategories.map(x => x.category[0]));\r\n    const topLevelCategories =  Array.from(topLevelNames).map(p => categoriesByPath.get(p)!);\r\n    return topLevelCategories;\r\n}\r\n\r\nfunction reifyCategories(flashcards: PlatonicFlashcard[]): Category[] {\r\n    return reifyHelper(flashcards.map(f => ({id: f.id, category: f.category})));\r\n}\r\n\r\n// console.log(reifyHelper([ \r\n//     {id: \"I\", category: [\"triad\", \"diatonic\", \"major\"]}, \r\n//     {id: \"bIII\", category: [\"triad\", \"diatonic\", \"minor\"]},\r\n//     {id: \"xya\", category: [\"dyad\", \"diatonic\"]}]));\r\n\r\nexport { Category , reifyCategories }","import { DerivedFlashcardId } from \"../models/flashcard\";\r\nimport { Priorities } from \"../models/options\";\r\nimport { randomNumberBetweenInclusive, shuffleArray } from \"../util/util\";\r\n\r\nexport { CardDrawer, PrioritiesCardDrawer }\r\n\r\ninterface CardDrawer {\r\n    drawCard(): DerivedFlashcardId;\r\n    recordAttempt(id: DerivedFlashcardId, success: boolean): void;\r\n    resetFlashcards(flashcards: DerivedFlashcardId[]): void;\r\n    resetPriorities(priorities: Priorities): void;\r\n}\r\n\r\ninterface AttemptHistory {\r\n    flashcardId: DerivedFlashcardId;\r\n    totalTries: number;\r\n    successful: number;\r\n    failed: number;\r\n}\r\n\r\ntype CardState = {kind: \"new\", index: number} | {kind: \"attempted\", index: number};\r\n\r\nclass PrioritiesCardDrawer implements CardDrawer {\r\n    private _priorities: Priorities;\r\n    private _lastCard: DerivedFlashcardId = \"\";\r\n\r\n    public _attempts: AttemptHistory[];\r\n    public _newCards: DerivedFlashcardId[];\r\n\r\n    public _flashcardToIndex: Map<DerivedFlashcardId, CardState>;\r\n\r\n    public constructor(flashcards: DerivedFlashcardId[], priorities: Priorities) {\r\n        this._newCards = [ ... flashcards ];\r\n        shuffleArray(this._newCards);\r\n\r\n        this._priorities = priorities;\r\n        this._attempts = []; \r\n\r\n        this._flashcardToIndex = new Map<string, CardState>();\r\n        this._newCards.forEach((n, i) => this._flashcardToIndex.set(n, {kind: \"new\", index: i}));\r\n    }\r\n\r\n    public resetPriorities(priorities: Priorities) {\r\n        this._priorities = priorities;\r\n    }\r\n\r\n    public drawCard(): string {\r\n        try {\r\n            if (this._attempts.length <= this._priorities.byPercentiles.length && this._newCards.length > 0) {\r\n                return this.drawNewCard();\r\n            } else if (this._newCards.length == 0) {\r\n                return this.drawAttemptedCard();\r\n            } else {\r\n                return pickByPercentages([\r\n                    [this._priorities.percentNew, () => this.drawNewCard()],\r\n                    [100 - this._priorities.percentNew, () => this.drawAttemptedCard()]\r\n                ]);\r\n            }\r\n        } catch (e) {\r\n            console.log(\"Big mess up trying to draw a card: \" + e);\r\n            return \"\";\r\n        }\r\n    }\r\n\r\n    private drawAttemptedCard(): string {\r\n        return drawFromEquallySizedGroupsBasedOnPercentages(this._priorities.byPercentiles, this._attempts).flashcardId;\r\n        // console.log(\"in drawAttemptedCard with lastCard: \" + this._lastCard);\r\n        // let attempt = this._lastCard; \r\n        // while (attempt != this._lastCard) {\r\n        //     console.log(\"inside this loop wehre we do work \" + attempt + \" -- \" + this._lastCard);\r\n        //     attempt = drawFromEquallySizedGroupsBasedOnPercentages(this._priorities.byPercentiles, this._attempts).flashcardId;\r\n        // }\r\n        // console.log(attempt + \" : \" + this._lastCard + \" : \" + (attempt == this._lastCard));\r\n        // this._lastCard = attempt;\r\n        // console.log(\"finna return with: \" + this._lastCard + \" -- \" + attempt);\r\n        // return attempt;\r\n    }\r\n\r\n    private drawNewCard(): string {\r\n        return this._newCards[this._newCards.length - 1];\r\n    }\r\n\r\n    public recordAttempt(id: string, success: boolean): void {\r\n        const currentPlace = this._flashcardToIndex.get(id);\r\n        console.log(currentPlace);\r\n\r\n        if (currentPlace?.kind == \"attempted\") {\r\n            const card = this._attempts[currentPlace.index];\r\n            card.totalTries++;\r\n            card.successful += success ? 1 : 0;\r\n            card.failed += success ? 0 : 1;\r\n            maintainSort(this._attempts, currentPlace.index, this._flashcardToIndex);\r\n\r\n        } else if (currentPlace?.kind == \"new\") {\r\n            if (currentPlace.index != this._newCards.length - 1) {\r\n                console.log(\"Invariant that new cards are always the last in the deck violated.\");\r\n                throw new Error(\"Invariant that new cards are always the last in the deck violated.\");\r\n            } else {\r\n                this._newCards.pop();\r\n                this._attempts.push({flashcardId: id, successful: success ? 1 : 0, failed: success ? 0 : 1, totalTries: 1});\r\n                this._flashcardToIndex.set(id, {kind: \"attempted\", index: this._attempts.length - 1});\r\n                maintainSort(this._attempts, this._attempts.length - 1, this._flashcardToIndex);\r\n            }\r\n        }\r\n    }\r\n\r\n    public resetFlashcards(flashcards: DerivedFlashcardId[]) {\r\n        const next = new Set(flashcards);\r\n        const current = new Set<DerivedFlashcardId>();\r\n        this._newCards.forEach(n => current.add(n));\r\n        this._attempts.forEach(a => current.add(a.flashcardId));\r\n\r\n        const add = [ ... next].filter(n => ! current.has(n));\r\n\r\n        this._newCards = this._newCards.filter(n => next.has(n));\r\n        this._attempts = this._attempts.filter(a => next.has(a.flashcardId));\r\n\r\n        this._newCards = this._newCards.concat([ ... add]);\r\n        shuffleArray(this._newCards);\r\n\r\n        this._flashcardToIndex = new Map<DerivedFlashcardId, CardState>();\r\n        this._newCards.forEach((n, i) => this._flashcardToIndex.set(n, {kind: \"new\", index: i}));\r\n        this._attempts.forEach((a, i) => this._flashcardToIndex.set(a.flashcardId, {kind: \"attempted\", index: i}));\r\n    }\r\n}\r\n\r\n//  like insertion sort\r\nfunction maintainSort(attempts: AttemptHistory[], index: number, locations: Map<DerivedFlashcardId, CardState>) {\r\n    const percentHit = (a: AttemptHistory) => (a.successful * a.successful / a.totalTries);\r\n    const lessThan = (a: AttemptHistory, b: AttemptHistory) => percentHit(a) < percentHit(b);\r\n    const greaterThan = (a: AttemptHistory, b: AttemptHistory) => percentHit(a) > percentHit(b);\r\n\r\n    function swap(list: AttemptHistory[], i: number, j: number) {\r\n        locations.get(list[i].flashcardId)!.index = j;\r\n        locations.get(list[j].flashcardId)!.index = i;\r\n\r\n        const tmp = list[i];\r\n        list[i] = list[j];\r\n        list[j] = tmp;\r\n    }\r\n\r\n    function maintainSortByTricklingDown(attempts: AttemptHistory[], index: number) {\r\n        while (index > 0 && lessThan(attempts[index], attempts[index - 1])) {\r\n            swap(attempts, index, index - 1);\r\n            index--;\r\n        }\r\n    }\r\n\r\n    function maintainSortByTricklingUp(attempts: AttemptHistory[], index: number) {\r\n        while (index < attempts.length - 1 && greaterThan(attempts[index], attempts[index + 1])) { \r\n            swap(attempts, index, index + 1);\r\n            index++;\r\n        }\r\n    }\r\n\r\n    maintainSortByTricklingUp(attempts, index);\r\n    maintainSortByTricklingDown(attempts, index);\r\n}\r\n\r\n\r\nfunction drawFromEquallySizedGroupsBasedOnPercentages<T>(percentages: IntegerPercentage[], list: T[]): T {\r\n    const partitions = percentages.length;\r\n    const indexGroups = divideEquallyIntoInclusiveIndices(list, partitions);\r\n    return pickByPercentages(percentages.map((percent, i) => [\r\n        percent, \r\n        () => list[randomNumberBetweenInclusive(indexGroups[i][0], indexGroups[i][1])]\r\n    ]));\r\n}\r\n\r\nfunction intoCumulativePercentages(priorities: number[]): number[] {\r\n    const result: number[] = [];\r\n    let soFar = 0;\r\n    priorities.forEach(p => {\r\n        result.push((soFar + p) / 100);\r\n        soFar += p;\r\n    });\r\n    return result;\r\n}\r\n\r\ntype IntegerPercentage = number;\r\nfunction pickByPercentages<T>(probabilitiesAndActions: [IntegerPercentage, () => T][]): T {\r\n    const cumulative = intoCumulativePercentages(probabilitiesAndActions.map(t => t[0]));\r\n    if (cumulative[cumulative.length - 1] != 1) {\r\n        console.log(\"Probabilities don't add up to 1\");\r\n        console.log(probabilitiesAndActions);\r\n        throw new Error(\"Probabilities don't add up to 1.\");\r\n    }\r\n    const r = Math.random();\r\n    let i = 0;\r\n    while (r > cumulative[i]) { \r\n        i ++;\r\n    }\r\n    return probabilitiesAndActions[i][1]();\r\n}\r\n\r\n\r\nfunction divideEquallyIntoInclusiveIndices<T>(list: T[], partitions: number): [number, number][] {\r\n    const roughSizePerGroupFrac = list.length / partitions;\r\n    const dividesCleanly = roughSizePerGroupFrac % 1 == 0;\r\n    const roughSizePerGroup = Math.ceil(roughSizePerGroupFrac);\r\n\r\n    const result: [number, number][] = [];\r\n\r\n    let low = 0;\r\n    let high = roughSizePerGroup - 1;\r\n\r\n    for (let i = 0; i < partitions; i++) {\r\n        const realHigh = Math.min(high, list.length - 1);\r\n        if (low <= realHigh) {\r\n            result.push([low, realHigh]);\r\n        }\r\n        low = realHigh + 1;\r\n        high = realHigh + (roughSizePerGroup - (i % 2 == 0 && !dividesCleanly ? 1 : 0))\r\n    }\r\n\r\n    if (result.length < partitions) {\r\n        result.reverse();\r\n        while (result.length < partitions) {\r\n            result.push(result[result.length - 1]);\r\n        }\r\n        result.reverse();\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n// let cd = new CardDrawer([\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"], {byPercentiles: [60, 30, 10], percentNew: 50});\r\n// console.log([ ... cd._flashcardToIndex]);\r\n// let card1  = cd.drawCard();\r\n// cd.recordAttempt(card1, true);\r\n\r\n// let card2  = cd.drawCard();\r\n// cd.recordAttempt(card2, true);\r\n\r\n// let card3  = cd.drawCard();\r\n// cd.recordAttempt(card3, false);\r\n\r\n// console.log([ ... cd._flashcardToIndex]);","import { Piano } from \"@tonejs/piano\";\r\nimport { start, context, Time, Transport } from \"tone\";\r\nimport { MusicalPhrase, Note, NoteToMidi } from \"../models/notes\";\r\nimport { PlayOptions } from \"../models/options\";\r\n\r\nexport { SoundPlayer, PianoPlayer }\r\n\r\n\r\ninterface SoundPlayer {\r\n    playMusicalPhrase(phrase: MusicalPhrase): void;\r\n    load(): Promise<boolean>;\r\n}\r\n\r\n\r\nclass PianoPlayer implements SoundPlayer {\r\n    private _piano: Piano = new Piano();\r\n    private _options: PlayOptions;\r\n\r\n    public constructor(options: PlayOptions) {\r\n        this._options = options;\r\n    };\r\n\r\n    public async load(): Promise<boolean> {\r\n        try {\r\n            await start();\r\n            await context.resume();\r\n            await this._piano.context.resume();\r\n            this._piano.toDestination();\r\n\r\n            await this._piano.load();\r\n\r\n            // Transport.bpm.value = this._options.bpm;\r\n\r\n            console.log(\"Piano load successful.\");\r\n            return true;\r\n        } catch (e) {\r\n            console.log(e);\r\n            return false;\r\n        }\r\n    }\r\n\r\n    public playMusicalPhrase(phrase: MusicalPhrase) {\r\n        let time = 0;\r\n        if (this._options.playReference) {\r\n            this.playChord([this._options.referenceNote], time, time + 1);\r\n            time++;\r\n        }\r\n        phrase.forEach(chord => {\r\n            this.playChord(chord, time, time + 1);\r\n            time++;\r\n        })\r\n    }\r\n\r\n    private playChord(notes: Note[], start: number, end: number) {\r\n        const bpmFactor = 60 / this._options.bpm;\r\n        // const toTime = (n: number) => \"+\" + Math.floor(n).toString();\r\n        const toTime = (n: number) => \"+\" + (n * bpmFactor).toString();\r\n\r\n        const midiNotes = notes.map(NoteToMidi);\r\n        midiNotes.forEach(n => this._piano.keyDown({midi: n, time: toTime(start)}));\r\n        midiNotes.forEach(n => this._piano.keyUp({midi: n, time: toTime(end)}));\r\n    }\r\n}","import { MidiNote, Note, NoteToMidi } from \"../models/notes\";\r\nimport { MidiBatcherConfig } from \"../models/options\";\r\n\r\nexport type MidiBatcherEvent = \r\n    {kind: \"rightAnswer\", onFirstGuess: boolean}\r\n    | {kind: \"giveUp\"}\r\n    | {kind: \"nextCard\"}\r\n    | {kind: \"replay\"}\r\n\r\nexport class MidiBatcher {\r\n    private _target: (MidiNote[])[] = [];\r\n    private _failedYet = false;\r\n    private _input: MidiNote[] = [];\r\n    private _batchSizes: number[] = [];\r\n    private _maxInputLength = 0;\r\n\r\n    private _config: MidiBatcherConfig;\r\n    private _emit: ((m: MidiBatcherEvent) => void);\r\n\r\n    constructor(config: MidiBatcherConfig, emit: (m: MidiBatcherEvent) => void)\r\n    {\r\n        this._config = config;\r\n        this._emit = emit;\r\n    }\r\n\r\n    setConfig(config: MidiBatcherConfig)\r\n    {\r\n        this._config = config;\r\n    }\r\n\r\n    setEmit(emit: (m: MidiBatcherEvent) => void)\r\n    {\r\n        this._emit = emit;\r\n    }\r\n\r\n    resetTarget(notes: (Note[])[]): void\r\n    {\r\n        this._target = notes.map(n => n.map(NoteToMidi));\r\n        this._failedYet = false;\r\n        this._input = [];\r\n        this._batchSizes = notes.map(n => n.length);\r\n        this._maxInputLength = this._batchSizes.reduce((a, x) => a + x, 0);\r\n    }\r\n\r\n    accept(note: MidiNote): void \r\n    {\r\n        if (note == NoteToMidi(this._config.giveUp)) {\r\n            this._emit({kind: \"giveUp\"});\r\n        } else if (note == NoteToMidi(this._config.nextCard)) {\r\n            this._emit({kind: \"nextCard\"});\r\n        } else if (note == NoteToMidi(this._config.replay)) {\r\n            this._emit({kind: \"replay\"});\r\n        } else {\r\n\r\n            this._input.push(note);\r\n            if (this._input.length < this._maxInputLength) {\r\n                // do nothing, we don't have enough to try matching yet\r\n            } else {\r\n                if (this._input.length > this._maxInputLength) {\r\n                    this._input.shift();\r\n                }\r\n\r\n                const batched = batch(this._input, this._batchSizes);\r\n\r\n                if (batchesEqual(batched, this._target)) {\r\n                    this._emit({kind: \"rightAnswer\", onFirstGuess: !this._failedYet});\r\n                } else {\r\n                    this._failedYet = true;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction batch<T>(inputs: T[], batchSizes: number[]): T[][] {\r\n    const batched: T[][] = [];\r\n    let i = 0;\r\n    batchSizes.forEach(batchSize => {\r\n        const batch: T[] = [];\r\n        for (let _ = 0; _ < batchSize && i < inputs.length; _++) {\r\n            batch.push(inputs[i++]);\r\n        }\r\n        batched.push(batch);\r\n    })\r\n    return batched;\r\n}\r\n\r\nfunction batchesEqual<T>(a: T[][], b: T[][]) {\r\n    function batchEqual<T>(a: T[], b: T[]): boolean {\r\n        const aSet = new Set(a);\r\n        return (a.length == b.length) && b.every(x => aSet.has(x));\r\n    }\r\n\r\n    if (a.length != b.length) {\r\n        return false;\r\n    } else {\r\n        for (let i = 0; i < a.length; i++) {\r\n            if (! batchEqual(a[i], b[i])) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n\r\n// console.log(batch([1,2,3,4,5,6,7,8,9], [3, 2, 1, 3]))\r\n\r\n// console.log(batchesEqual([1,2,3], [2,3,1]))\r\n// console.log(batchesEqual([1,2,3], [3,1]))\r\n// console.log(batchesEqual([2,3], [3,1]))\r\n\r\n// let events: MidiBatcherEvent[] = [];\r\n// let m = new MidiBatcher({giveUp: 100, replay: 101, nextCard: 102}, x => events.push(x));\r\n// m.resetTarget([\r\n//     [{kind: \"midi\", midi: 1}, {kind: \"midi\", midi: 2}],\r\n//     [{kind: \"midi\", midi: 11}],\r\n//     [{kind: \"midi\", midi: 21}, {kind: \"midi\", midi: 22}]\r\n// ]);\r\n\r\n// m.accept(100);\r\n// console.log(events);\r\n// m.accept(1); m.accept(2); m.accept(11);\r\n// console.log(events);\r\n// m.accept(1); m.accept(2); m.accept(11); m.accept(22); m.accept(21);\r\n// console.log(events);\r\n// console.log(events);","import { PlatonicFlashcard, DerivedFlashcard, DerivedFlashcardId, chordEntityToModel, polychord, sequence, octaveInstantiatedChord } from \"../models/flashcard\";\r\nimport { Note, PitchClass, NoteToMidi, Octave, solfegeNote, midiNote, scientificNote } from \"../models/notes\";\r\nimport { mapcat, shuffleArray, drawRandomSample, RandomSampleRepeatOptions, doTimes } from \"../util/util\";\r\nimport { DerivationOptions } from \"../models/options\";\r\n\r\nexport function derive(options: DerivationOptions, flashcards: PlatonicFlashcard[]): DerivedFlashcard[] {\r\n    if (options.tonality.kind == \"tonal\") {\r\n        const transposed = mapcat(flashcards, f => instantiateInOctaves(f, options.lowestNote, options.highestNote, options.tonality.tonic));\r\n        shuffleArray(transposed);\r\n\r\n        if (options.chunkSize <= 1 && !options.apreggiateChords) {\r\n            return transposed.slice(0, Math.min(options.cards, transposed.length));\r\n        // todo: there should be a totally separate generation here, to allow for ascending and descending\r\n        } else if (options.chunkType == \"sequence\" || options.apreggiateChords) {\r\n            return doTimes(() => createSequence(transposed, options.chunkSize, options.apreggiateChords, options.repeats), options.cards);\r\n        } else if (options.chunkType == \"polychord\") {\r\n            return doTimes(() => createPolychord(transposed, options.chunkSize), options.cards);\r\n        } else {\r\n            throw new Error(\"Unsupported chunkType: \" + options.chunkType);\r\n        }\r\n        // generate pool between lowest/highest\r\n        // function to sample for sequence\r\n\r\n    } else {\r\n        throw new Error(\"Unsupported tonality type.\");\r\n    }\r\n}\r\n\r\nfunction chordNotes(card: DerivedFlashcard): Note[] {\r\n    if (card.kind == \"octave-instantiated-chord\") {\r\n        return card.notes;\r\n    } else {\r\n        throw new Error(\"Can't take notes out of non-chord derived: \" + card.kind);\r\n    }\r\n}\r\n\r\nfunction createSequence(flashcards: DerivedFlashcard[], chunkSize: number, arpeggiate: boolean, sampleOptions: RandomSampleRepeatOptions): DerivedFlashcard {\r\n    const cards = drawRandomSample(flashcards, chunkSize, sampleOptions);\r\n    return sequence(arpeggiate ? [mapcat(cards, chordNotes)] : cards.map(chordNotes), cards.map(c => c.id));\r\n}\r\n\r\nfunction createPolychord(flashcards: DerivedFlashcard[], chunkSize: number): DerivedFlashcard {\r\n    const cards = drawRandomSample(flashcards, chunkSize, \"no-repeats\");\r\n    const uniqueNotes = [ ... new Set<number>(mapcat(cards, chordNotes).map(NoteToMidi))];\r\n    uniqueNotes.sort();\r\n    return polychord(uniqueNotes.map(midiNote), cards.map(c => c.id));\r\n}\r\n\r\nfunction instantiateInOctaves(flashcard: PlatonicFlashcard, lowestNote: Note, highestNote: Note, tonicPitch: PitchClass): DerivedFlashcard[] {\r\n    const octaves: Octave[] = [2, 3, 4, 5, 6];\r\n    const lowestNoteMidi = NoteToMidi(lowestNote);\r\n    const highestNoteMidi = NoteToMidi(highestNote);\r\n\r\n    if (flashcard.kind == \"chord\") {\r\n        const result: DerivedFlashcard[] = [];\r\n        octaves.forEach(o => {\r\n            const tonic = scientificNote(tonicPitch, o);\r\n            const candidate = octaveInstantiatedChord(\r\n                o,\r\n                tonicPitch,\r\n                flashcard.notes.map(n => solfegeNote(n, tonic)),\r\n                flashcard.id\r\n            );\r\n            const midis = chordNotes(candidate).map(NoteToMidi);\r\n            const max = Math.max(... midis);\r\n            const min = Math.min(... midis);\r\n\r\n            if (max <= highestNoteMidi && min >= lowestNoteMidi) {\r\n                result.push(candidate);\r\n            };\r\n        })\r\n\r\n        return result;\r\n\r\n    } else {\r\n        console.log(\"Trying to octave displace unsupported flashcard type: \" + flashcard.kind);\r\n        return [];\r\n    }\r\n}\r\n\r\nconst f1 = chordEntityToModel({\r\n    function: \"I\",\r\n    category: \"sdkljg\",\r\n    inv: \"R 3 5\", \r\n    notes: \"do mi so\"\r\n});\r\nconst f2 = chordEntityToModel({\r\n    function: \"ii\",\r\n    category: \"sdkljg\",\r\n    inv: \"R 3 5\", \r\n    notes: \"re fa la\"\r\n});\r\n\r\n// console.log(drawRandomSample([1,2,3,4], 3, \"no-repeats\"))\r\n// console.log(drawRandomSample([1,2,3,4], 3, \"no-repeats\"))\r\n// console.log(drawRandomSample([1,2,3,4], 3, \"no-repeats\"))\r\n// console.log(drawRandomSample([1,2,3,4], 3, \"no-repeats\"))\r\n// console.log(drawRandomSample([1,2,3,4], 3, \"no-repeats\"))\r\n\r\n// console.log(drawRandomSample([1,2,3,4], 3, \"non-sequential-repeats\"))\r\n// console.log(drawRandomSample([1,2,3,4], 3, \"non-sequential-repeats\"))\r\n// console.log(drawRandomSample([1,2,3,4], 3, \"non-sequential-repeats\"))\r\n// console.log(drawRandomSample([1,2,3,4], 3, \"non-sequential-repeats\"))\r\n// console.log(drawRandomSample([1,2,3,4], 3, \"non-sequential-repeats\"))\r\n// console.log(drawRandomSample([1,2,3,4], 3, \"non-sequential-repeats\"))\r\n// console.log(drawRandomSample([1,2,3,4], 3, \"non-sequential-repeats\"))\r\n// console.log(drawRandomSample([1,2,3,4], 3, \"non-sequential-repeats\"))\r\n// console.log(drawRandomSample([1,2,3,4], 3, \"non-sequential-repeats\"))\r\n// console.log(drawRandomSample([1,2,3,4], 3, \"non-sequential-repeats\"))\r\n\r\n\r\n// console.log(instantiateInOctaves(f1, scientificNote(\"A\", 3), scientificNote(\"A\", 5), \"B\"));\r\n    // ({kind: \"chord\", function: string, inversion: string, notes: OctaveSolfegeRelative[], category: string[]});","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Watch } from \"vue-property-decorator\";\nimport HelloWorld from \"./components/HelloWorld.vue\";\nimport FlashcardSelector from \"./components/FlashcardSelector.vue\";\nimport OptionsEditor from \"./components/OptionsEditor.vue\";\nimport { Piano } from '@tonejs/piano';\nimport { VBtn, VContainer, VRow, VCol, VTabs, VApp, VMain, VTabItem, VTab } from \"vuetify/lib\";\n\nimport { chordEntities } from './flashcards/chords/chord-entities';\nimport { PlatonicFlashcard, DerivedFlashcard, chordEntityToModel, PlatonicFlashcardId, DerivedFlashcardId, getMusicalPhrase } from './domain/models/flashcard';\nimport { reifyCategories , Category } from './domain/models/category';\nimport { Options, defaultOptions } from './domain/models/options';\nimport { PrioritiesCardDrawer, CardDrawer } from './domain/services/cardDrawer';\nimport { SoundPlayer, PianoPlayer } from './domain/services/soundPlayer';\nimport { Note, NoteToMidi, scientificNote } from \"./domain/models/notes\";\nimport { MidiBatcher } from \"./domain/services/midiBatcher\";\nimport { derive } from \"./domain/services/flashcardDeriver\";\nimport { indexBy } from \"./domain/util/util\";\nimport webmidi, { WebMidi } from \"webmidi\";\n\ninterface PracticeState {\n  currentCardId: DerivedFlashcardId;\n  wrongGuesses: number;\n  giveUp: boolean;\n}\n\n@Component ({\n  components: {\n    FlashcardSelector, OptionsEditor,\n    VApp, VMain,\n    VTabs, VTab, VTabItem,\n    VContainer, VRow, VCol,\n    VBtn\n  }\n})\nexport default class App extends Vue {\n  private options: Options = defaultOptions;\n  private chords: PlatonicFlashcard[] = chordEntities.map(chordEntityToModel);\n  private selectedFlashcardIds: PlatonicFlashcardId[] = [];\n  private categories: Category[] = reifyCategories(this.chords);\n\n  private activeFlashcards: DerivedFlashcard[] =[];\n\n  private cardDrawer: CardDrawer = new PrioritiesCardDrawer(this.selectedFlashcardIds, this.options.priorities);\n  private player: SoundPlayer | undefined = undefined;\n\n  private midiBatcher: MidiBatcher = new MidiBatcher(\n    defaultOptions.commands,\n    _ => console.log(\"got midi event, not sure what to do with it yet.\"));\n\n  private pianoLoaded = false;\n\n  private practiceState: PracticeState = {currentCardId: \"\", wrongGuesses: 0, giveUp: false};\n\n  async loadAll() {\n    // load cards\n    this.cardDrawer.resetPriorities(this.options.priorities);\n    const platonicCardsById = indexBy(this.chords, c => c.id);\n    this.activeFlashcards = derive(this.options.derivation, this.selectedFlashcardIds.map(f => platonicCardsById.get(f)!));\n    this.cardDrawer.resetFlashcards(this.activeFlashcards.map(f => f.id));\n\n    // load piano and midi\n    this.player = new PianoPlayer(this.options.play);\n    await this.player.load();\n    this.pianoLoaded = true;\n\n    webmidi.enable(ex => {\n      if (ex != undefined) {\n        console.log(\"Error trying to setup midi listener: \" + ex.name);\n      } else {\n        console.log(\"Successfully set up midi listner.\")\n      }\n\n      console.log(webmidi.inputs);\n      console.log(webmidi.outputs);\n\n      if (webmidi.inputs.length == 0) {\n        console.log(\"No midi input device detected.\");\n      }\n\n      const input = webmidi.inputs[0];\n      input.addListener(\"noteon\", \"all\", e => {\n        this.midiBatcher.accept(e.note.number);\n      });\n    }, true);\n\n    this.midiBatcher.setEmit(event => {\n      if (event.kind == \"giveUp\") {\n        this.giveUp();\n      } else if (event.kind == \"replay\") {\n        this.playCard();\n      } else if (event.kind == \"nextCard\") {\n        this.recordResult(false);\n        this.drawCard();\n        this.playCard();\n      } else if (event.kind == \"rightAnswer\") {\n        this.recordResult(event.onFirstGuess);\n        this.drawCard();\n        this.playCard();\n      }\n    });\n\n    this.drawCard();\n    this.playCard();\n  }\n\n  drawCard() {\n    try {\n      this.practiceState = {currentCardId: this.cardDrawer.drawCard(), wrongGuesses: 0, giveUp: false};\n      const currentCard = this.currentCard!;\n      this.midiBatcher.resetTarget(getMusicalPhrase(currentCard));\n    } catch (e) {\n      console.log(e);\n    }\n  }\n\n  recordResult(success: boolean) {\n    try {\n      this.cardDrawer.recordAttempt(this.practiceState.currentCardId, success);\n      this.drawCard();\n    } catch (e) {\n      console.log(e);\n    }\n  }\n\n  playCard() {\n    const currentCard = this.currentCard;\n\n    this.player!.playMusicalPhrase(getMusicalPhrase(currentCard!));\n  }\n\n  giveUp() {\n    this.practiceState.giveUp = true;\n  }\n\n  get chordsbyId(): Map<DerivedFlashcardId, DerivedFlashcard> {\n    const result = new Map<DerivedFlashcardId, DerivedFlashcard>();\n    this.activeFlashcards.forEach(c => result.set(c.id, c));\n    return result;\n  }\n\n  get currentCard(): DerivedFlashcard | undefined {\n    return this.chordsbyId.get(this.practiceState.currentCardId);\n  }\n\n  get currentCardDescription(): string {\n    return this.currentCard == undefined \n      ? \"\"\n      : this.currentCard.id;\n  }\n}\n\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=7d695e5a&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from \"vue\";\nimport Vuex from \"vuex\";\n\nVue.use(Vuex);\n\nexport default new Vuex.Store({\n  state: {},\n  mutations: {},\n  actions: {},\n  modules: {}\n});\n","import Vue from \"vue\";\r\nimport App from \"./App.vue\";\r\nimport store from \"./store\";\r\nimport Vuetify from \"vuetify/lib\";\r\n\r\nimport 'vuetify/dist/vuetify.min.css';\r\n\r\nconst vuetify = new Vuetify({});\r\n\r\nVue.use(Vuetify);\r\n\r\nVue.config.productionTip = false;\r\n\r\nnew Vue({\r\n  vuetify,\r\n  store,\r\n  render: h => h(App)\r\n}).$mount(\"#app\");"],"sourceRoot":""}